---
title: "AI 에이전트의 USB-C, MCP — OAuth로 보안을 잡으려다 생긴 구멍"
date: "2026-02-20T11:00:00.000Z"
description: "'API 키 없이 한 번만 인증하세요'를 약속했던 Anthropic의 MCP OAuth. 그런데 보안 연구팀이 그 기본 설정에서 공급망 공격으로 이어질 수 있는 취약점 2개를 발견했다."
tags: ["MCP", "OAuth", "Anthropic", "보안", "AI에이전트", "개발자도구"]
series: "AI 심층 분석"
seriesPart: 2
---

<Figure
  src="/images/posts/mcp-oauth/claude-code-mcp-oauth.jpg"
  alt="Claude Code가 OAuth를 통해 원격 MCP 서버에 연결하는 모습"
  caption="Claude Code의 네이티브 OAuth 지원 — 개발자 인증을 한 번에 해결하겠다는 약속이었다"
  credit="Anthropic"
  creditUrl="https://claude.com/blog/claude-code-remote-mcp"
  priority={true}
/>

## "이제 API 키는 없다" — MCP가 약속한 것

2025년 6월, Anthropic이 개발자들이 오래 기다리던 발표를 했다.

**Model Context Protocol(MCP)** — AI 어시스턴트가 외부 서비스와 통신하는 공통 표준. GitHub, Notion, 내부 데이터베이스… 어떤 서비스든 하나의 프로토콜로 연결하겠다는 개념이다. 흔히 "AI 에이전트의 USB-C"라 불린다.

그리고 Claude Code에는 **네이티브 OAuth 지원**이 탑재됐다. 발표문의 핵심 문구는 이랬다:

> "서버에 한 번만 인증하면 Claude Code가 나머지를 처리합니다 — 관리할 API 키도, 저장할 자격 증명도 없습니다."

개발자들은 열광했다. MCP 생태계는 빠르게 성장했다. 수백 개의 서버가 몇 달 안에 출시됐다.

그런데 그 발표로부터 한 달 후, 보안 연구팀이 조용히 버그 리포트를 제출했다.

---

## 취약점 2개를 발견한 보안 연구팀

2025년 7월, **Cato Networks CTRL** 위협 연구팀이 Anthropic의 MCP SDK — 대부분의 개발자가 기반으로 쓰는 기본 구현체 — 에서 취약점 2개를 발견했다.

<Figure
  src="/images/posts/mcp-oauth/mcp-oauth-vulnerability.jpg"
  alt="MCP SDK OAuth 취약점 공격 체인 다이어그램"
  caption="공격 흐름: 잘못된 CORS 설정 → 토큰 탈취 → CI/CD 침투 → 공급망 공격"
  credit="Cato Networks"
  creditUrl="https://www.catonetworks.com/blog/cato-ctrl-two-vulnerabilities-in-anthropics-mcp-sdk/"
/>

### 취약점 1: OAuth 토큰 탈취

MCP SDK를 OAuth 인증 서버로 사용할 때, 세 개의 핵심 엔드포인트가 **기본값이 너무 열려 있었다**:

- `/register` — 동적 클라이언트 등록
- `/authorize` — OAuth 인증
- `/token` — 토큰 발급

이 엔드포인트들은 **어떤 도메인에서든 크로스오리진 요청을 허용**했다. 리다이렉트 URI 검증도 느슨했다.

공격 시나리오: 개발자가 회사 MCP 환경에 로그인된 상태(GitHub, Bitbucket, CI/CD 시스템에 연결된)로 악성 웹사이트를 방문한다. 그 사이트가 조용히:

1. `/register`로 가짜 OAuth 클라이언트 등록
2. 인증 플로우 완료
3. 자신의 서버로 리다이렉트해 토큰 캡처

개발자 화면엔 아무것도 표시되지 않는다. 공격자는 이제 유효한 개발자 토큰을 가졌다 — 그 개발자가 MCP에 연결된 모든 시스템에 대한 권한과 함께.

### 취약점 2: 공급망 공격 가능성

여기서 이야기가 소름끼치는 방향으로 흘러간다.

MCP가 발급한 토큰을 CI/CD 파이프라인이 신뢰하는 조직에서는, 토큰 하나가 털리면 단순히 리포지토리 하나가 노출되는 게 아니다:

- 소스 코드에 악성 코드 삽입
- 자동 빌드 트리거
- 서명된 바이너리 생성 (모든 진위 확인 통과)
- 공급업체의 업데이트 서버를 통해 고객 환경 전체에 배포

완전히 인증되고, 완전히 서명됐으며, 모든 다운스트림 시스템이 완전히 신뢰하는 악성 코드. 2020년 **SolarWinds 사태**와 같은 구조다.

---

## Anthropic의 대응

Cato는 **2025년 7월 8일** 리포트를 제출했다. Anthropic이 공식 인정한 건 **2025년 9월 4일**. 그리고 그 답변이 기술적으로는 정확하지만, 불편하게 읽힌다:

> "이 발견 사항은 공식 명세서의 'Confused Deputy Problem' 항목에 서술된 보안 시나리오와 일치합니다."

번역하자면: *우리는 이런 위험 유형이 있다는 걸 알고 문서화도 했습니다. 하지만 기본 SDK 설정이 그 완화책을 강제하지 않았습니다.*

이후 "더 명확한 가이드라인과 개선된 기본 설정"을 약속했다. 2026년 초 기준, MCP 명세는 **2025-11-25 버전**까지 발전하며 인증 요구사항이 보다 구체화됐다.

---

## OAuth 2.1 + PKCE가 해결하는 것과 못 하는 것

현재 MCP 인증 명세는 **OAuth 2.1**과 **PKCE(Proof Key for Code Exchange)**를 요구한다. 이전보다 확실히 나아진 방향이다.

**PKCE가 막는 것:**
- OAuth 코드 교환 과정에서의 인터셉트 공격
- 탈취된 인증 코드를 토큰으로 교환하는 시도

**PKCE가 막지 못하는 것:**
- 클라이언트 인증 — 서버는 여전히 "어떤 앱"이 요청하는지 검증하기 어렵다
- PKCE 적용 전에 등록된 위협적인 리다이렉트 URI
- 인프라 수준의 위협 (CI/CD 서버 자체가 침해된 경우)

AI 에이전트 특유의 근본적인 긴장도 있다: **OAuth는 인간의 인증 플로우를 위해 설계됐다** — 사용자가 "허용" 버튼을 클릭하고, 요청을 확인하고, 앱이 토큰을 받는다. AI 에이전트는 자율적으로 동작하며, 예상치 못한 인증 요청을 확인해 줄 인간이 없는 경우가 많다.

이게 진짜 어려운 문제다. PKCE는 그 답의 일부지만, 비인간(non-human) 신원 문제는 해결하지 못한다.

---

## 개발자가 지금 당장 해야 할 것

MCP 서버를 만들거나 Claude Code를 인프라와 연동하고 있다면:

**CORS를 즉시 제한하라.** OAuth 엔드포인트의 기본 허용 CORS는 위험하다. 알려진 오리진만 허용하도록 잠가라.

**리다이렉트 URI를 엄격하게 검증하라.** 임의의 리다이렉트 URI를 허용하는 인증 플로우는 토큰 탈취로 이어진다.

**토큰 권한을 최소화하라.** "전체 개발자 접근권"을 가진 토큰을 발급하지 마라. MCP 서버마다 실제로 필요한 최소 권한만 부여하라.

**SDK 기본값이 명세를 따르지 않는다는 걸 기억하라.** MCP 명세는 SDK가 항상 강제하지 않는 보안 가이드라인을 포함한다. 명세와 SDK는 다르다.

---

## 더 큰 그림

MCP는 진짜 유용하다. Claude Code의 OAuth 통합은 개발자 워크플로우를 실질적으로 개선한다. 이 문제들이 그 기술이 근본적으로 잘못됐다는 의미가 아니다 — 모든 보안 민감한 표준이 성숙하는 과정이다: 연구자가 허점을 찾고, 공개하고, 패치하고, 기본값이 개선된다.

주목할 건 AI 에이전트가 더 자율적으로 진화하면서 이 문제가 어떻게 전개되느냐다. 지금은 대부분의 MCP 플로우 근처에 인간이 있다. 에이전트들이 독립적으로 작업을 예약하고, 코드를 작성하고, 배포를 트리거하는 능력이 늘어날수록, 인증 아키텍처가 위협 모델을 따라잡아야 한다.

OAuth 2.1 + PKCE는 시작이다. 인프라 기반 신원 검증, 단기 토큰, 비인간 클라이언트 인증 체계가 향후 방향이다.

USB-C 비유는 여전히 나쁘지 않다. USB도 보안 모델을 제대로 잡는 데 몇 세대가 걸렸으니까.

---

*출처: [Cato Networks CTRL 위협 연구](https://www.catonetworks.com/blog/cato-ctrl-two-vulnerabilities-in-anthropics-mcp-sdk/) · [Anthropic Claude Code Remote MCP](https://claude.com/blog/claude-code-remote-mcp) · [Stack Overflow Blog: MCP 인증](https://stackoverflow.blog/2026/01/21/is-that-allowed-authentication-and-authorization-in-model-context-protocol/) · [MCP 인증 명세](https://modelcontextprotocol.io/specification/2025-11-25)*
